import{ap as c,aq as d,ax as m,ak as p,ay as g,r as _,az as x,aA as v,aB as h,aC as C,j as f,aD as D,aE as l}from"./index-Cz5SRk5r.js";import{c as j,s as o}from"./socetApi-DM_Stpay.js";import"./index-1HjZlvs3.js";function S(){const e=c(d),{conversations:r,currentConversation:i}=c(m),a=p(),u=g();return _.useEffect(()=>{if(e)return o||j(e._id),o.on("start_chat",s=>{const t=r.find(n=>(n==null?void 0:n.id)===s._id);a(t?x({conversation:s}):v({conversation:s})),a(h({chatId:s._id}))}),o.on("new_message",s=>{const t=s.message;(i==null?void 0:i.id)===s.conversation_id&&a(C({id:t._id,type:"msg",subtype:t.type,message:t.text,incoming:t.to===e._id,outgoing:t.from===e._id}))}),()=>{var s,t;(s=o)==null||s.off("start_chat"),(t=o)==null||t.off("new_message")}},[r,i,a,e]),e?f.jsx(D,{}):f.jsx(l,{to:"/SignIn",state:{from:u},replace:!0})}export{S as default};
