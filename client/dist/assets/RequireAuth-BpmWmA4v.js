import{an as c,ao as d,av as m,ak as g,aw as p,r as _,ax as v,ay as x,az as h,aA as C,j as f,aB as l,aC as D}from"./index-D3_g4cYm.js";import{c as j,s as o}from"./socetApi-CnRMkNN6.js";import"./index-1HjZlvs3.js";function k(){const e=c(d),{conversations:r,currentConversation:i}=c(m),a=g(),u=p();return _.useEffect(()=>{if(e)return o||j(e._id),o.on("start_chat",s=>{const t=r.find(n=>(n==null?void 0:n.id)===s._id);a(t?v({conversation:s}):x({conversation:s})),a(h({chatId:s._id}))}),o.on("new_message",s=>{const t=s.message;(i==null?void 0:i.id)===s.conversation_id&&a(C({id:t._id,type:"msg",subtype:t.type,message:t.text,incoming:t.to===e._id,outgoing:t.from===e._id}))}),()=>{var s,t;(s=o)==null||s.off("start_chat"),(t=o)==null||t.off("new_message")}},[r,i,a,e]),e?f.jsx(l,{}):f.jsx(D,{to:"/SignIn",state:{from:u},replace:!0})}export{k as default};
